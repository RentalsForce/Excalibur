<!--
 - Created by Мастер Эш on 16.12.2019.
 -->

<!-- Assessments -->
<template>
    <div class='cover'>

        <template if:true={mainSpinner}>
            <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
        </template>

        <div class="slds-tabs_default">
            <ul class="slds-tabs_default__nav" role="tablist">
                <li class="slds-tabs_default__item slds-is-active tab" title="Item One" role="presentation" data-tab="newTargets">
                    <a class="slds-tabs_default__link tab-label" href="#"
                       role="tab" tabindex="0"
                       aria-selected="true"
                       aria-controls="tab-default-1"
                       onclick={tabClick}
                       id="tab-default-1__item">NEW
                    </a>
                </li>
                <li class="slds-tabs_default__item tab" title="Item Two" role="presentation" data-tab="inProgress">
                    <a class="slds-tabs_default__link tab-label" href="#"
                       role="tab" tabindex="-1"
                       aria-selected="false"
                       aria-controls="tab-default-2"
                       onclick={tabClick}
                       id="tab-default-2__item">IN PROGRESS
                    </a>
                </li>
                <li class="slds-tabs_default__item tab" title="Item Two" role="presentation" data-tab="completed">
                    <a class="slds-tabs_default__link tab-label" href="#"
                       role="tab" tabindex="-1"
                       aria-selected="false"
                       aria-controls="tab-default-2"
                       onclick={tabClick}
                       id="tab-default-3__item">READY FOR SUBMIT
                    </a>
                </li>
                <li class="slds-tabs_default__item tab" title="Item Three" role="presentation" data-tab="submitted">
                    <a class="slds-tabs_default__link tab-label" href="#"
                       role="tab" tabindex="-1"
                       aria-selected="false"
                       aria-controls="tab-default-3"
                       onclick={tabClick}
                       id="tab-default-4__item">COMPLETED
                    </a>
                </li>
            </ul>
        </div>
        
        <div class='assessments newTargets'>
            <template for:each={newAssessments} for:item='assessment'>
                <div key={assessment.name} class='assessment newTargets' data-assid={assessment.targetId}>
                    <article class="slds-card assessmentItem" data-type="newTargets" data-assid={assessment.targetId} onclick={openAssessment}>
                        <div class="slds-card__header slds-grid">
                            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                <div class="slds-media__figure">
                                    <template if:false={assessment.currentAssessment}>
                                        <lightning-icon icon-name='standard:account' size='small'></lightning-icon>
                                    </template>
                                    <template if:true={assessment.currentAssessment}>
                                        <lightning-icon icon-name='action:back' size='small'></lightning-icon>
                                    </template>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-card__header-title">
                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                            <span>{assessment.name}</span>
                                        </a>
                                    </h2>
                                </div>
                                <div class="slds-no-flex">
<!--                                    <button class="slds-button slds-button_neutral">New</button>-->
                                </div>
                            </header>
                        </div>
                    </article>
                </div>
            </template>

            <template if:true={currentNewAssessment}>
                <div class="libs">
                    <template for:each={currentNewAssessment.newQuestionnaires} for:item='lib'>
                        <div key={lib.name} class='lib' data-libid={lib.libId}>
                            <article class="slds-card libItem" data-libid={lib.libId} data-type="newTargets">
                                <div class="slds-card__header slds-grid">
                                    <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                        <div class="slds-media__figure">
                                            <lightning-icon icon-name='standard:document' size='small'></lightning-icon>
                                        </div>
                                        <div class="slds-media__body">
                                            <div class='slds-grid'>
                                                <div class='slds-col' style='width: 50%'>
                                                    <h2 class="slds-card__header-title" style='padding: 5px'>
                                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                                            <span>{lib.name}</span>
                                                        </a>
                                                    </h2>
                                                </div>
                                                <div class='slds-col'>
                                                    <div class='slds-grid'>
                                                        <div class='slds-col' style='max-width: 50px'>
                                                            <lightning-icon icon-name='standard:date_input' size='small' style="margin-top: 7%;"></lightning-icon>
                                                        </div>
                                                        <div class='slds-col' style='width: 5%;'>
                                                            <div>
                                                                Created Date:
                                                            </div>
<!--                                                            <div>-->
<!--                                                                Due Date:-->
<!--                                                            </div>-->
                                                        </div>
                                                        <div class='slds-col'>
                                                            <div>
                                                                {lib.createdDate}
                                                            </div>
<!--                                                            <div>-->
<!--                                                                {lib.createdDate}-->
<!--                                                            </div>-->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-no-flex">
                                            <template if:false={lib.completed}>
                                                <button class="slds-button slds-button_brand circle-button white-button"
                                                        onclick={openLib}>Take
                                                </button>
                                            </template>
                                            <template if:true={lib.completed}>
                                                <lightning-icon icon-name='action:approval' size='small'></lightning-icon>
                                            </template>
                                        </div>
                                    </header>
                                </div>
                            </article>
                        </div>
                    </template>
                </div>
            </template>
        </div>

        <div class='assessments inProgress slds-hide'>
            <template for:each={inProgressAssessments} for:item='assessment'>
                <div key={assessment.name} class='assessment inProgress' data-assid={assessment.targetId}>
                    <article class="slds-card assessmentItem" data-type="inProgress" data-assid={assessment.targetId} onclick={openAssessment}>
                        <div class="slds-card__header slds-grid">
                            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                <div class="slds-media__figure">
                                    <template if:false={assessment.currentAssessment}>
                                        <lightning-icon icon-name='standard:account' size='small'></lightning-icon>
                                    </template>
                                    <template if:true={assessment.currentAssessment}>
                                        <lightning-icon icon-name='action:back' size='small'></lightning-icon>
                                    </template>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-card__header-title">
                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                            <span>{assessment.name}</span>
                                        </a>
                                    </h2>
                                </div>
                                <div class="slds-no-flex">
                                    <!--                                    <button class="slds-button slds-button_neutral">New</button>-->
                                </div>
                            </header>
                        </div>
                    </article>
                </div>
            </template>

            <template if:true={currentInprogressAssessment}>
                <div class="libs">
                    <template for:each={currentInprogressAssessment.startedQuestionnaires} for:item='lib'>
                        <div key={lib.name} class='lib' data-libid={lib.libId}>
                            <article class="slds-card libItem" data-libid={lib.libId} data-type="inProgress">
                                <div class="slds-card__header slds-grid">
                                    <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                        <div class="slds-media__figure">
                                            <lightning-icon icon-name='standard:document' size='small'></lightning-icon>
                                        </div>
                                        <div class="slds-media__body">
                                            <div>
                                                <div class="slds-progress-bar slds-progress-bar_small" aria-valuemin="0" aria-valuemax="100" aria-valuenow="25" role="progressbar">
                                                  <span class="slds-progress-bar__value" style={lib.stylePercent}>
                                                    <span class="slds-assistive-text">Current Progress</span>
                                                  </span>
                                                </div>
                                            </div>
                                            <div class='slds-grid'>
                                                <div class='slds-col' style='width: 50%'>
                                                    <h2 class="slds-card__header-title" style='margin-top: 1.5%'>
                                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                                            <span>{lib.name}</span>
                                                        </a>
                                                    </h2>
                                                </div>
                                                <div class='slds-col'>
                                                    <div class='slds-grid'>
                                                        <div class='slds-col' style='max-width: 50px'>
                                                            <lightning-icon icon-name='standard:date_input' size='small' style="margin-top: 7%;"></lightning-icon>
                                                        </div>
                                                        <div class='slds-col' style='width: 5%;'>
                                                            <div>
                                                                Created Date:
                                                            </div>
<!--                                                            <div>-->
<!--                                                                Due Date:-->
<!--                                                            </div>-->
                                                        </div>
                                                        <div class='slds-col'>
                                                            <div>
                                                                {lib.createdDate}
                                                            </div>
<!--                                                            <div>-->
<!--                                                                {lib.createdDate}-->
<!--                                                            </div>-->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-no-flex">
                                            <template if:false={lib.completed}>
                                                <button class="slds-button slds-button_brand circle-button white-button"
                                                        onclick={openLib}>Take
                                                </button>
                                            </template>
                                            <template if:true={lib.completed}>
                                                <lightning-icon icon-name='action:approval' size='small'></lightning-icon>
                                            </template>
                                        </div>
                                    </header>
                                </div>
                            </article>
                        </div>
                    </template>
                </div>
            </template>
        </div>

        <div class='assessments completed slds-hide'>
            <template for:each={completedAssessments} for:item='assessment'>
                <div key={assessment.name} class='assessment completed' data-assid={assessment.targetId}>
                    <article class="slds-card assessmentItem" data-type="completed" data-assid={assessment.targetId} onclick={openAssessment}>
                        <div class="slds-card__header slds-grid">
                            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                <div class="slds-media__figure">
                                    <template if:false={assessment.currentAssessment}>
                                        <lightning-icon icon-name='standard:account' size='small'></lightning-icon>
                                    </template>
                                    <template if:true={assessment.currentAssessment}>
                                        <lightning-icon icon-name='action:back' size='small'></lightning-icon>
                                    </template>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-card__header-title">
                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                            <span>{assessment.name}</span>
                                        </a>
                                    </h2>
                                </div>
                                <div class="slds-no-flex">
                                </div>
                            </header>
                        </div>
                    </article>
                </div>
            </template>

            <template if:true={currentCompletedAssessment}>
                <div class="libs">
                    <template for:each={currentCompletedAssessment.completedQuestionnaires} for:item='lib'>
                        <div key={lib.name} class='lib' data-libid={lib.libId}>
                            <article class="slds-card libItem" data-libid={lib.libId} data-type="completed">
                                <div class="slds-card__header slds-grid">
                                    <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                        <div class="slds-media__figure">
                                            <template if:false={lib.open}>
                                                <lightning-icon icon-name='standard:document' size='small'></lightning-icon>
                                            </template>
                                            <template if:true={lib.open}>
                                                <lightning-icon icon-name='action:back' size='small'></lightning-icon>
                                            </template>
                                        </div>
                                        <div class="slds-media__body open_assessment"
                                             data-libid={lib.libId}
                                             onclick={openCompleted}>
                                            <div class='slds-grid'>
                                                <div class='slds-col'
                                                     style='width: 50%; cursor: pointer'
                                                     data-libid={lib.libId}>
                                                    <h2 class="slds-card__header-title" style='margin-top: 1.5%'>
                                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                                            <span>{lib.name}</span>
                                                        </a>
                                                    </h2>
                                                </div>
                                                <div class='slds-col'>
                                                    <div class='slds-grid'>
                                                        <div class='slds-col' style='max-width: 50px'>
                                                            <lightning-icon icon-name='standard:date_input' size='small' style="margin-top: 7%;"></lightning-icon>
                                                        </div>
                                                        <div class='slds-col' style='width: 5%;'>
                                                            <div>
                                                                Created Date:
                                                            </div>
                                                            <div>
                                                                Completed Date:
                                                            </div>
                                                        </div>
                                                        <div class='slds-col'>
                                                            <div>
                                                                {lib.createdDate}
                                                            </div>
                                                            <div>
                                                                {lib.completedDate}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-no-flex">
                                            <template if:false={lib.completed}>
                                                <button class="slds-button slds-button_brand circle-button white-button"
                                                        onclick={openLib}>Take
                                                </button>
                                            </template>
                                            <template if:true={lib.completed}>
                                                <button class="slds-button slds-button_neutral circle-button white-button"
                                                        data-targetresult={lib.targetResult}
                                                        onclick={retakeAssessment}>ReTake
                                                </button>
                                                <button class="slds-button slds-button_neutral circle-button white-button"
                                                        data-targetresult={lib.targetResult}
                                                        onclick={submitAssessment}>Submit
                                                </button>
<!--                                                <lightning-icon icon-name='action:approval' size='small'></lightning-icon>-->
                                            </template>
                                        </div>
                                    </header>
                                </div>
                            </article>
                        </div>

                        <template if:true={lib.open}>
                            <div class='questions_holder' key={lib.libId}>
                                <template for:each={lib.results} for:item='answer'>
                                    <div key={answer.answerId} class='lib' data-libid={lib.libId} data-questionid={answer.questionId}>
                                        <article class="slds-card questionItem" data-libid={lib.libId} data-type="completed">
                                            <div class="slds-card__header slds-grid">
                                                <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                                    <div class="slds-media__figure">
                                                        <lightning-icon icon-name='action:question_post_action' size='small'></lightning-icon>
                                                    </div>
                                                    <div class="slds-media__body">
                                                        <div class='slds-grid'>
                                                            <div class='slds-col open_assessment'
                                                                 style='width: 50%; cursor: pointer'
                                                                 data-libid={lib.libId}>
                                                                <h2 class="slds-card__header-title">
                                                                    <lightning-formatted-rich-text value={answer.questionText}></lightning-formatted-rich-text>
                                                                </h2>
                                                            </div>
                                                            <div class='slds-col'>
                                                                <div class='slds-grid'>
<!--                                                                    <div class='slds-col' style='max-width: 50px'>-->
<!--                                                                        <lightning-icon icon-name='standard:date_input' size='small' style="margin-top: 7%;"></lightning-icon>-->
<!--                                                                    </div>-->
                                                                    <div class='slds-col' style='width: 5%;'>
                                                                        <div>
                                                                            Your Answer:
                                                                        </div>
                                                                    </div>
                                                                    <div class='slds-col'>
                                                                        <div>
                                                                            {answer.result}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="slds-no-flex" style='width: 14%'>
                                                        <template if:true={answer.canChange}>
                                                            <button class="slds-button slds-button_brand circle-button white-button"
                                                                    data-answerid={answer.answerId}
                                                                    onclick={openChangeModal}>
                                                                Change Attachments
                                                            </button>
                                                        </template>
                                                    </div>
                                                </header>
                                            </div>
                                        </article>
                                    </div>
                                </template>
                            </div>
                        </template>

                    </template>
                </div>
            </template>
        </div>

        <div class='assessments submitted slds-hide'>
            <template for:each={submittedAssessments} for:item='assessment'>
                <div key={assessment.name} class='assessment submitted' data-assid={assessment.targetId}>
                    <article class="slds-card assessmentItem" data-type="submitted" data-assid={assessment.targetId} onclick={openAssessment}>
                        <div class="slds-card__header slds-grid">
                            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                <div class="slds-media__figure">
                                    <template if:false={assessment.currentAssessment}>
                                        <lightning-icon icon-name='standard:account' size='small'></lightning-icon>
                                    </template>
                                    <template if:true={assessment.currentAssessment}>
                                        <lightning-icon icon-name='action:back' size='small'></lightning-icon>
                                    </template>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-card__header-title">
                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                            <span>{assessment.name}</span>
                                        </a>
                                    </h2>
                                </div>
                                <div class="slds-no-flex">
                                </div>
                            </header>
                        </div>
                    </article>
                </div>
            </template>

            <template if:true={currentSubmittedAssessment}>
                <div class="libs">
                    <template for:each={currentSubmittedAssessment.submittedQuestionnaires} for:item='lib'>
                        <div key={lib.name} class='lib' data-libid={lib.libId}>
                            <article class="slds-card libItem" data-libid={lib.libId} data-type="submitted">
                                <div class="slds-card__header slds-grid">
                                    <header class="slds-media slds-media_center slds-has-flexi-truncate">
                                        <div class="slds-media__figure">
                                            <lightning-icon icon-name='standard:document' size='small'></lightning-icon>
                                        </div>
                                        <div class="slds-media__body">
                                            <div class='slds-grid'>
                                                <div class='slds-col' style='width: 50%'>
                                                    <h2 class="slds-card__header-title" style='margin-top: 1.5%'>
                                                        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
                                                            <span>{lib.name}</span>
                                                        </a>
                                                    </h2>
                                                </div>
                                                <div class='slds-col'>
                                                    <div class='slds-grid'>
                                                        <div class='slds-col' style='max-width: 50px'>
                                                            <lightning-icon icon-name='standard:date_input' size='small' style="margin-top: 7%;"></lightning-icon>
                                                        </div>
                                                        <div class='slds-col' style='width: 5%;'>
                                                            <div>
                                                                Completed Date:
                                                            </div>
                                                            <div>
                                                                Submitted Date:
                                                            </div>
                                                        </div>
                                                        <div class='slds-col'>
                                                            <div>
                                                                {lib.completedDate}
                                                            </div>
                                                            <div>
                                                                {lib.submittedDate}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-no-flex">
                                            <template if:true={lib.submitted}>
                                                <lightning-icon icon-name='action:approval' size='small'></lightning-icon>
                                            </template>
                                        </div>
                                    </header>
                                </div>
                            </article>
                        </div>
                    </template>
                </div>
            </template>
        </div>

        <template if:true={questionModal}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <template if:true={waitQuestion}>
                    <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                </template>
                <div class="slds-modal__container">
                    <header class="slds-modal__header modal-header">
                        <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{currentQuestion.name}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <template if:false={additions}>
                            <lightning-formatted-rich-text value={currentQuestion.questionText}></lightning-formatted-rich-text>
                            <template if:true={currentNotes}>
                                <lightning-accordion class="example-accordion" active-section-name="C" >
                                    <lightning-accordion-section onclick={handleOpenSection} name="B" label="Notes">
                                        <template for:each={currentNotes} for:item='note'>
                                            <div key={note.Id}>
                                                <template if:true={note.richBody}>
                                                    <div>
                                                        <lightning-formatted-rich-text value={note.richBody}></lightning-formatted-rich-text>
                                                    </div>
                                                </template>
                                                <template if:true={note.haveImage}>
                                                    <div style='text-align: center'>
                                                        <img src={note.image}/>
                                                    </div>
                                                </template>
                                            </div>
                                        </template>
                                    </lightning-accordion-section>
                                    <div class='slds-hide'>
                                        <lightning-accordion-section name="C" label="">
                                        </lightning-accordion-section>
                                    </div>
                                </lightning-accordion>
                            </template>
                        </template>

                        <template if:true={additions}>

                            <template if:true={additions.note}>
                                <div>
                                    <lightning-input-rich-text value={additions.note} onkeyup={handleNote} formats={formats}>
                                    </lightning-input-rich-text>
                                </div>
                            </template>

                            <template if:true={additions.photo}>
                                <template if:false={havePhoto}>
                                    <div class="slds-form-element" style='text-align: center'>
                                        <span class="slds-form-element__label" id="file-selector-primary-label">Attachment</span>
                                        <div class="slds-form-element__control">
                                            <div class="slds-file-selector slds-file-selector_files">
                                                <div class="slds-file-selector__dropzone">
                                                    <input type="file"
                                                           class="slds-file-selector__input slds-assistive-text"
                                                           accept="image/*, application/pdf"
                                                           onchange={handleFiles}
                                                           id="file-upload-input-01"
                                                           aria-labelledby="file-selector-primary-label file-selector-secondary-label" />
                                                    <label class="slds-file-selector__body" for="file-upload-input-01" id="file-selector-secondary-label">
                                                  <span class="slds-file-selector__button slds-button slds-button_neutral">
                                                    <lightning-icon icon-name='utility:upload' size='small'></lightning-icon>
                                                      Upload Attachment</span>
                                                        <span class="slds-file-selector__text slds-medium-show">or Drop Files</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                                <template if:true={havePhoto}>
                                    <div style='text-align: center; margin-top: 10px; margin-bottom: 10px'>
                                        <button class="slds-button slds-button_outline-brand remove"
                                                style='width: 100%'
                                                onclick={removeFile}>Remove Attachment
                                        </button>
                                    </div>
                                </template>
                                <div style='text-align: center'>
                                    <template if:true={answerFile}>
                                        <template if:true={answerFile.image}>
                                            <img class='uploadedPhoto' src={answerFile.base64body}/>
                                        </template>
                                        <template if:true={answerFile.pdf}>
                                            <lightning-icon icon-name='doctype:pdf' size='large'></lightning-icon>
                                            <p>{answerFile.fileName}</p>
                                        </template>
                                    </template>
                                </div>
                            </template>
                        </template>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_brand circle-button"
                                style='float: left; background-color: grey'
                                onclick={closeModal}>Cancel
                        </button>
                        <template if:false={additions}>
                            <template if:false={currentQuestion.first}>
                                <button class='slds-button slds-button_brand circle-button'
                                        style='float: left; background-color: grey'
                                        onclick={questionBack}>
                                <span class='slds-icon_container slds-icon_container--circle' >
                                    <svg class="slds-icon slds-icon-text-default" aria-hidden="true" style='fill: white;width: 18px; height: 15px'>
                                          <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#back"></use>
                                    </svg>
                                </span>
                                    Back
                                </button>
                            </template>
                            <template if:true={currentLib.haveNext}>
                                <template if:true={currentQuestion.answer}>
                                    <button class='slds-button slds-button_brand circle-button'
                                            style='float: left; background-color: grey'
                                            onclick={questionNext}>
                                        Next
                                        <span class='slds-icon_container slds-icon_container--circle' >
                                    <svg class="slds-icon slds-icon-text-default" aria-hidden="true" style='fill: white;width: 18px; height: 15px'>
                                          <use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#forward"></use>
                                    </svg>
                                </span>
                                    </button>
                                </template>
                            </template>
                        </template>
                        <template if:false={additions}>
                            <template if:false={currentQuestion.answer}>
                                <button class="slds-button slds-button_brand circle-button white-button" data-answer="yes" onclick={setQuestionResult}>Yes</button>
                                <button class="slds-button slds-button_brand circle-button white-button" data-answer="no" onclick={setQuestionResult}>No</button>
                            </template>
                            <template if:true={currentQuestion.answer}>
                                <button class="slds-button slds-button_brand circle-button white-button" data-mode="answer_change" onclick={openMessageModal} >Change Answer</button>
                            </template>
                        </template>
                        <template if:true={additions}>
                            <button class="slds-button slds-button_neutral circle-button circle-button-skip" disabled={sendDisabled} onclick={sendAnswer}>Skip Additions</button>
                        </template>
                        <template if:true={additions}>
                            <button class="slds-button slds-button_neutral circle-button circle-button-submit" disabled={sendDisabled} onclick={sendAnswer}>Submit</button>
                        </template>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <template if:true={changeAttachmentsModal}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <template if:true={waitQuestion}>
                    <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                </template>
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <lightning-formatted-rich-text value={openedAnswer.questionText}></lightning-formatted-rich-text>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-2">
                        <template if:true={openedAnswer.haveNote}>
                            <div>
                                <lightning-input-rich-text value={openedAnswer.note} formats={formats} onkeyup={changeAnswerNote}></lightning-input-rich-text>
                            </div>
                        </template>
                        <template if:true={openedAnswer.haveImage}>
                            <template if:true={openedAnswer.imageString}>
                                <div style='text-align: center; margin-top: 10px; margin-bottom: 10px'>
                                    <button class="slds-button slds-button_outline-brand remove"
                                            style='width: 100%'
                                            onclick={removeAnswerImage}>Remove Attachment
                                    </button>
                                </div>
                                <div style='text-align: center'>
                                    <img src={openedAnswer.imageString}/>
                                </div>
                            </template>
                            <template if:false={openedAnswer.imageString}>
                                <div class="slds-form-element" style='text-align: center'>
                                    <span class="slds-form-element__label" id="file-selector-primary-label-answer">Attachment</span>
                                    <div class="slds-form-element__control">
                                        <div class="slds-file-selector slds-file-selector_files">
                                            <div class="slds-file-selector__dropzone">
                                                <input type="file"
                                                       class="slds-file-selector__input slds-assistive-text"
                                                       accept="image/*"
                                                       onchange={handleAnswerFiles}
                                                       id="file-upload-input-01-answer"
                                                       aria-labelledby="file-selector-primary-label-answer file-selector-secondary-label-answer" />
                                                <label class="slds-file-selector__body" for="file-upload-input-01-answer" id="file-selector-secondary-label-answer">
                                                  <span class="slds-file-selector__button slds-button slds-button_neutral">
                                                    <lightning-icon icon-name='utility:upload' size='small'></lightning-icon>
                                                      Upload Attachment</span>
                                                    <span class="slds-file-selector__text slds-medium-show">or Drop Files</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </template>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_brand circle-button white-button" onclick={closeChangeModal}>Cancel</button>
                        <button class="slds-button slds-button_brand circle-button white-button" disabled={changeDisabled} onclick={changeAnswer}>Change</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <template if:true={messageModal.open}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <template if:true={waitQuestion}>
                    <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                </template>
                <div class="slds-modal__container">
                    <header class="slds-modal__header modal-header">
                        <h2 id="modal-heading-03" class="slds-modal__title slds-hyphenate">{messageModal.header}</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-3">
                        <p>{messageModal.body}</p>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_brand circle-button white-button" onclick={closeMessageModal}>Cancel</button>
                        <button class="slds-button slds-button_brand circle-button white-button" onclick={continueFromMessage}>Continue</button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

    </div>
</template>